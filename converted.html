<h1><b>Cleanup</b> <b>Steps</b></h1><table><tbody><tr><th>Created</th><th>December 16, 2022 2<br/>55 PM</th></tr><tr><td>Last<br/>Edited Time</td><th>June 12, 2024 4<br/>21 PM</th></tr><tr><td>Status</td><th>Released ðŸŽ‰</th></tr><tr><td>Created<br/>By</td><th>Nicholas Carter</th></tr><tr><td>Last<br/>Edited By</td><th>Nicholas Carter</th></tr><tr><td>Stakeholders</td><th>Haruhiko Kubo<br/>Meiko Hori<br/>Samuel Ostrom<br/>Ryota Nishimura</th></tr><tr><td>Label</td><th>Web</th></tr><tr><td>Design<br/>Link</td><th>https://www.figma.com/file/RWXxw9wcjN9zEivDPeBcOl/Clean-up<br/>Steps?node-id=1%3A64&amp;t=1CwFX9v9Be46NnoC-1</th></tr><tr><td>Proposal<br/>Doc</td><th>https://www.notion.so/autifyhq/Clean-up-Steps<br/>49c682c3996745c7b7979795a11c7967</th></tr><tr><td>Overview/Problem Statement<br/>Value Proposition</td><th></th></tr><tr><td>Requirements</td><th></th></tr><tr><td colspan="2">On the Scenario Details Screen</td></tr><tr><td colspan="2">On the Scenario List Screen</td></tr><tr><td colspan="2">On the Test Results List Screen</td></tr><tr><td></td><th>On the Test Results Detail Screen</th></tr><tr><td colspan="2">On Autify Admin</td></tr><tr><td colspan="2">Happy Path</td></tr><tr><td colspan="2">DESIGN MOCKUPS</td></tr><tr><td colspan="2">Not in Scope</td></tr><tr><td colspan="2">User Role Permissions</td></tr><tr><td colspan="2">Success Metrics/Data</td></tr><tr><td></td><th>Technical proposal (go the technical document to get latest version)</th></tr><tr><td>Release Timelines and Estimates</td><th></th></tr><tr><td>Checklist for QA team</td><th></th></tr><tr><td></td><th></th></tr><tr><td>Checklist for CS team</td><th></th></tr><tr><td>Documentation</td><th></th></tr><tr><td></td><th>:<br/>:</th></tr></tbody></table><div block_type="$$PAGEBREAK$$"></div><p block-type="Text"><a href="#page-8-0">Checklist for Marketing&amp;Sales</a> <a href="#page-8-1">Announcement</a> <a href="#page-8-2">Release</a> <a href="#page-8-3">Other checklist</a> <a href="#page-9-0">Notes </a>@<a href="#page-9-0">August 29, 2023</a> Notes @March 14, 2023 Notes @March 7, 2023 Notes @March 3, 2023 Notes @February 22, 2023 Notes @February 14, 2023 Notes @February 8, 2023</p><h2><span id="page-1-0"></span><b>Overview/Problem</b> <b>Statement</b></h2><p block-type="Text">Users will often create steps in their tests which require the creation of new user or other data within a test scenario, however after a test is complete users do not want this created data to stay. They want to cleanup data that is showing up on their UI and can be deleted from the frontend. They are mainly concerned with changing ID's and not having those UI elements sticking around.</p><p block-type="Text">Currently the internal Cleanup steps feature works as follows -</p><p block-type="Text">How to use Cleanup</p><h2><span id="page-1-1"></span><b>Value</b> <b>Proposition</b></h2><p block-type="Text">We had 3 customers give us specific feedback with needs regarding cleanup steps and decided not to go with us because of it. I think we could have closed at least 2 more customers for $900 MRR with some more features to solve these issues.</p><p block-type="Text">Current number of requests on Productboard - <a href="https://autify.productboard.com/feature-board/3548337-feature-prioritization/features/10590582/insights">30</a></p><h1><span id="page-1-2"></span><b>Requirements</b></h1><h3><span id="page-1-3"></span><b>On</b> <b>the</b> <b>Scenario</b> <b>Details</b> <b>Screen</b></h3><p block-type="Text">Cleanup steps will be displayed in a separate section below the regular steps in a scenario</p><p block-type="Text">Tooltips to be shown in the Cleanup steps section as per the design.</p><div block_type="$$PAGEBREAK$$"></div><p block-type="Text">The insert (+) menu will be functional in the Cleanup steps sections</p><p block-type="Text">Users should be able to mark steps and copy/paste as cleanup steps from the scenario editor screen.</p><p block-type="ListGroup"><ul><li block-type="ListItem">Marked steps will go to the beginning of the Cleanup steps section.</li><li block-type="ListItem">Steps which should NOT be able to be <b>marked or pasted</b> as Cleanup steps <ul><li block-type="ListItem" class="list-indent-1">Element should look the same</li></ul><ul><li block-type="ListItem" class="list-indent-1">Step Groups or SGA</li></ul></li></ul></p><p block-type="Text">Users should be able to unmark cleanup steps back to regular steps</p><p block-type="Text">Unmarked steps are added to the end of the regular steps</p><p block-type="Text">Users can rearrange clean up steps within the Cleanup steps section</p><p block-type="Text">Users can drag and drop steps into the Cleanup steps section</p><p block-type="Text">An error modal should be displayed if the users tries to drag and drop steps which cannot be marked as Cleanup Steps</p><p block-type="Text">Users can drag and drop Cleanup steps back to the regular step sequence</p><p block-type="Text">On the scenario edit screen the total number of steps counter should be broken down into regular and cleanup steps on mouseover</p><p block-type="Text">A visit step can be selected but the only options would be to mark/unmark as a cleanup step.</p><p block-type="Text">Add an Options tab to the scenario editor screen. Options tab will allow control of Cleanup Steps, Data tab and Variables tab being viewable or hidden.</p><p block-type="Text">If there are any active Cleanups Steps, Data or Variables the hide toggle will be disabled.</p><p block-type="Text">Cleanup steps to be able to export values</p><p block-type="Text">For local replay</p><p block-type="ListGroup"><ul><li block-type="ListItem">If all regular steps pass the local reply will continue and replay the Cleanup steps.</li><li block-type="ListItem">If any regular steps fail the replay will stop and any Cleanup steps will not be executed.</li></ul></p><h3><span id="page-2-0"></span><b>On</b> <b>the</b> <b>Scenario</b> <b>List</b> <b>Screen</b></h3><p block-type="Text">Scenarios with active Cleanup steps should show a Cleanup icon</p><div block_type="$$PAGEBREAK$$"></div><h3><span id="page-3-0"></span><b>On</b> <b>the</b> <b>Test</b> <b>Results</b> <b>List</b> <b>Screen</b></h3><p block-type="Text">If a cleanup step fails in a test execution it should result in that test showing as failed.</p><p block-type="Text">Using the existing failed icon</p><h3><span id="page-3-1"></span><b>On</b> <b>the</b> <b>Test</b> <b>Results</b> <b>Detail</b> <b>Screen</b></h3><p block-type="Text">Tests with cleanup steps should show them in a separate section in the test results detail screen, below the regular steps.</p><p block-type="Text">If test with a Cleanup steps fails during any of the non-cleanup up steps, the cleanup steps should still be executed.</p><p block-type="Text">If the cleanup steps cannot be executed a specific error message should be shown in test results (same error detail as if a regular step failed now in the current UI)</p><h3><span id="page-3-2"></span><b>On</b> <b>Autify</b> <b>Admin</b></h3><p block-type="Text">The feature should have a toggle to be enabled/disabled in Autify admin as per the new pricing plan requirements.</p><p block-type="ListGroup"><ul><li block-type="ListItem">If disabled in admin <ul><li block-type="ListItem" class="list-indent-1">The cleanup steps checkbox on the options tab will not be visible</li></ul><ul><li block-type="ListItem" class="list-indent-1">Any existing cleanup steps will not be visible in scenario editor</li></ul><ul><li block-type="ListItem" class="list-indent-1">Any tests run that had cleanup steps before disabling will skip the Cleanup steps part during execution</li></ul><ul><li block-type="ListItem" class="list-indent-1">Previous test runs with cleanup steps will still be visible in test results detail screen.</li></ul></li></ul></p><h3><span id="page-3-3"></span><b>Happy</b> <b>Path</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">As a user, I want to convert the recorded steps into the cleanup steps</li><li block-type="ListItem">As a user, I want to see the cleanup steps execution result in the test scenario results page</li></ul></p><h3><span id="page-3-4"></span><b>DESIGN</b> <b>MOCKUPS</b></h3><div block_type="$$PAGEBREAK$$"></div><p block-type="Text"><a href="https://www.figma.com/file/RWXxw9wcjN9zEivDPeBcOl/Clean-up-Steps?node-id=1%3A64&amp;t=JG5QZr7lHWHMq1Lq-1">https://www.figma.com/file/RWXxw9wcjN9zEivDPeBcOl/Clean-</a></p><p block-type="Text"><a href="https://www.figma.com/file/RWXxw9wcjN9zEivDPeBcOl/Clean-up-Steps?node-id=1%3A64&amp;t=JG5QZr7lHWHMq1Lq-1">up-Steps?node</a><a href="https://www.figma.com/file/RWXxw9wcjN9zEivDPeBcOl/Clean-up-Steps?node-id=1%3A64&amp;t=JG5QZr7lHWHMq1Lq-1">id=1%3A64&amp;t=JG5QZr7lHWHMq1Lq-1</a> (note: if you cannot view the design, please request access) Last updated: 2/22/23</p><p block-type="Text">https://www.figma.com/file/RWXxw 9wcjN9zEivDPeBcOl/Clean-up-Ste ps?node-id=0%3A1&amp;t=JG5QZr7lH WHMq1Lq-1</p><h4>ZEPLIN <a href="https://zpl.io/09xDDDK">https://zpl.io/09xDDDK</a></h4><h3><span id="page-4-0"></span><b>Not</b> <b>in</b> <b>Scope</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">Data staging / before hook ( __cleanup__ ), we will focus on the __cleanup_only__ as in the existing cleanup functionality.</li><li block-type="ListItem">Cleanup steps can be in the middle of a scenario</li><li block-type="ListItem">Toggle cleanup steps in the recorder</li><li block-type="ListItem">Cleanup steps inside a step group</li><li block-type="ListItem">Step groups can be marked as cleanup steps</li></ul></p><h2><span id="page-4-1"></span><b>User</b> <b>Role</b> <b>Permissions</b></h2><p block-type="ListGroup"><ul><li block-type="ListItem">Workspace manager and editor would have access to all functionality in this feature.  <ul><li block-type="ListItem" class="list-indent-1">User Roles Permission Matrix -</li></ul></li></ul></p><p block-type="Text"><a href="https://docs.google.com/spreadsheets/d/1mdXM7kOSGYbrWY2-kZGF6FFA6OIBsrimSd8gA2KgEUU/edit#gid=613193027&amp;range=B13">https://docs.google.com/spreadsheets/d/1mdXM7kOSGYbrWY2</a> <a href="https://docs.google.com/spreadsheets/d/1mdXM7kOSGYbrWY2-kZGF6FFA6OIBsrimSd8gA2KgEUU/edit#gid=613193027&amp;range=B13">kZGF6FFA6OIBsrimSd8gA2KgEUU/edit#gid=613193027&amp;range=B13</a></p><h2><span id="page-4-2"></span><b>Success</b> <b>Metrics/Data</b></h2><p block-type="ListGroup" class="has-continuation"><ul><li block-type="ListItem">Number of created cleanup steps</li><li block-type="ListItem">Number of customers with cleanup steps enabled</li><li block-type="ListItem">Number of scenarios with cleanup steps enabled</li><li block-type="ListItem">Outcome Metrics <ul><li block-type="ListItem" class="list-indent-1">The feature is used by 10% of eligible customers after 3 months</li></ul></li></ul></p><div block_type="$$PAGEBREAK$$"></div><p block-type="ListGroup"><ul><li block-type="ListItem">Any Feedback received from current and demo customers about this feature.</li><li block-type="ListItem">Scenarios with Cleanup steps see increased run frequency over non-cleanup scenarios</li></ul></p><h1><b>Technical proposal (go the technical</b> <b>document to get latest version)</b></h1><h3><b>Clean</b> <b>up</b> <b>steps,</b> <b>Core</b> <b>implementation</b> <b>(register</b> <b>update</b> <b>and</b> <b>execute</b> <b>cleanup</b> <b>steps)</b></h3><h4><b>Database:</b></h4><p block-type="ListGroup"><ul><li block-type="ListItem">Add a is_cleanup bool field default false on the steps table</li><li block-type="ListItem">Add an "options" jsonb field on scenarios table to contain the display options described in PRD</li></ul></p><h3><b>Web</b> <b>backend:</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">Return that field on the related types and arguments (scenario types + step related ones)</li><li block-type="ListItem">Ensure that the newly created fields are properly added / managed on scenario history / duplicate</li><li block-type="ListItem">Change Main.json generation code so that we can add the clean up flag for each steps ( in the case we use SGA, are we supposed to</li></ul></p><h4><b>Worker:</b></h4><p block-type="Text">segregate steps that have the cleanup step flag set to false/true</p><p block-type="Text">False =&gt; normal step to be executed.</p><p block-type="Text">True =&gt; clean up steps that have to be executed during the cleanups</p><h3><b>Web</b> <b>frontend:</b></h3><p block-type="Text">segregate steps that have the cleanup step flag set to false/true (they will be returned as a single list)</p><p block-type="Text">False =&gt; display as normal steps</p><p block-type="Text">True =&gt; display as clean up steps</p><div block_type="$$PAGEBREAK$$"></div><p block-type="Text">To avoid breaking the step numbers displayed in test case results. Once we move a step in the cleanup section, we consider them moved somewhere at the end of the step list.</p><p block-type="Text">eg:</p><p block-type="Text">Step list:</p><p block-type="ListGroup"><ul><li block-type="ListItem">Step 1</li><li block-type="ListItem">Step 2</li><li block-type="ListItem">Step 3</li><li block-type="ListItem">Step 4</li></ul></p><p block-type="Text">Clean up step list:</p><p block-type="Text">Clean up step 1</p><p block-type="Text">Steps Arguments sent to the mutation:</p><p block-type="ListGroup"><ul><li block-type="ListItem">Step 1</li><li block-type="ListItem">Step 2</li><li block-type="ListItem">Step 3</li><li block-type="ListItem">Step 4</li><li block-type="ListItem">Clean up step 1</li></ul></p><p block-type="Text">If we move step 3 to clean up step these 3 arrays will look like follow</p><p block-type="Text">Step list:</p><p block-type="ListGroup"><ul><li block-type="ListItem">Step 1</li><li block-type="ListItem">Step 2</li><li block-type="ListItem">Step 4</li></ul></p><p block-type="Text">Clean up step list:</p><p block-type="ListGroup"><ul><li block-type="ListItem">Clean up step 1</li><li block-type="ListItem">Step 3</li></ul></p><p block-type="Text">Steps Arguments sent to the mutation:</p><p block-type="ListGroup" class="has-continuation"><ul><li block-type="ListItem">Step 1</li><li block-type="ListItem">Step 2</li></ul></p><div block_type="$$PAGEBREAK$$"></div><p block-type="ListGroup"><ul><li block-type="ListItem">Step 4</li><li block-type="ListItem">Clean up step 1</li><li block-type="ListItem">Step 3</li></ul></p><h3><b>Things</b> <b>not</b> <b>addressed:</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">Formatting and display in test case result</li><li block-type="ListItem">Do we count the execution in the case of an internal error on clean up step</li><li block-type="ListItem">Still not sure how we want to handle SGA (we could say that if an sga is put in cleanup all subsequent steps are marked as cleanup only for this scenario)</li><li block-type="ListItem">Feature toggle manageable within the scenario (show clean up steps)</li><li block-type="ListItem">What are the cleanup tickets we need to create</li></ul></p><h2><span id="page-7-0"></span><b>Release</b> <b>Timelines</b> <b>and</b> <b>Estimates</b></h2><p block-type="ListGroup"><ul><li block-type="ListItem">Roadmap Schedule  Q3 2023</li><li block-type="ListItem">Design Estimate -</li><li block-type="ListItem">Engineering Estimate  5 sprints  <a href="https://www.notion.so/Cleanup-Steps-Rough-Time-Estimate-e0ac287399e047889af858aba00736e3?pvs=21">Cleanup Steps: Rough Time Estimate</a> **Updated after design change (3/17)</li></ul></p><h2><span id="page-7-1"></span><b>Checklist</b> <b>for</b> <b>QA</b> <b>team</b></h2><p block-type="ListGroup"><ul><li block-type="ListItem">Review the user stories</li><li block-type="ListItem">Check whether bug bash is required or not</li></ul></p><h1><span id="page-7-2"></span><b>Checklist</b> <b>for</b> <b>CS</b> <b>team</b></h1><h3><span id="page-7-3"></span><b>Documentation</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">It's a new feature</li><li block-type="ListItem">It introduces new pages</li><li block-type="ListItem">It changes the existing pages</li></ul></p><div block_type="$$PAGEBREAK$$"></div><p block-type="ListGroup"><ul><li block-type="ListItem">It changes the content of existing items</li><li block-type="ListItem">It changes the current flow</li><li block-type="ListItem">New or changed terminology has been added</li></ul></p><h2><span id="page-8-0"></span><b>Checklist</b> <b>for</b> <b>Marketing&amp;Sales</b></h2><p block-type="ListGroup"><ul><li block-type="ListItem">Need sales deck</li><li block-type="ListItem">Need a page on website</li><li block-type="ListItem">Need talk script</li><li block-type="ListItem">Decide the name of the function</li><li block-type="ListItem">It will be a paid option? <ul><li block-type="ListItem" class="list-indent-1">Yes</li></ul><ul><li block-type="ListItem" class="list-indent-1">No</li></ul></li></ul></p><h3><span id="page-8-1"></span><b>Announcement</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">It requires a down time</li><li block-type="ListItem">It requires users to be logged out</li><li block-type="ListItem">It requires users some tasks such as clearing cache or recreating scenarios</li><li block-type="ListItem">It introduces any other visible changes</li></ul></p><h3><span id="page-8-2"></span><b>Release</b></h3><p block-type="ListGroup"><ul><li block-type="ListItem">Release behind a feature flag</li><li block-type="ListItem">Release as Public beta</li><li block-type="ListItem">Normal release</li></ul></p><h1><span id="page-8-3"></span><b>Other</b> <b>checklist</b></h1><div block_type="$$PAGEBREAK$$"></div><p block-type="Text">(If any of "Documentation" item was checked) The name of the feature of the page has defined (Both in Japanese and English)</p><p block-type="Text">There is a draft for the announcement</p><h2><span id="page-9-0"></span><b>Notes</b></h2><p block-type="Text">Whether or not to hide the feature by default:</p><p block-type="Text">https://autifyhq.slack.com/archives/CV1NGMXEG/p1693298370148449</p><h4><span id="page-9-1"></span><b>Notes</b> <b>@March</b> <b>14,</b> <b>2023</b></h4><p block-type="ListGroup"><ul><li block-type="ListItem">New Design -</li><li block-type="ListItem">How to show/hide cleanup steps</li></ul></p><h4><span id="page-9-2"></span><b>Notes</b> <b>@March</b> <b>7,</b> <b>2023</b></h4><h4><a href="https://www.notion.so/Cleanup-Steps-UX-chat-61dd1c3faeec4885aee5e69d9b640430?pvs=21">Cleanup Steps: UX chat</a></h4><p block-type="ListGroup"><ul><li block-type="ListItem">Changes/Simplifications based on above discussion <ul><li block-type="ListItem" class="list-indent-1">Separate the Cleanup steps in scenario view to a separate section</li></ul><ul><li block-type="ListItem" class="list-indent-1">Add better feature introduction/tooltips</li></ul><ul><li block-type="ListItem" class="list-indent-1">Add ability to hide Cleanup steps section from scenario view</li></ul></li><li block-type="ListItem">Remove the mark all scenario as Cleanup steps as there is no added usefulness in this feature shown as normal in a separate section <b>@August</b> <b>29,</b> <b>2023</b> <ul><li block-type="ListItem" class="list-indent-1">Remove the new Cleanup failed badge, tests with failed cleanup steps will just be marked as failed as per regular steps failing <ul><li block-type="ListItem" class="list-indent-2">In the future will add a new column to the test results list to give a failure reason so a new badge is not needed.</li></ul></li></ul><ul><li block-type="ListItem" class="list-indent-1">Cleanup steps in the test results page detail screen will not be collapsable just</li></ul></li></ul></p><div block_type="$$PAGEBREAK$$"></div><h4><span id="page-10-0"></span><b>Notes</b> <b>@March</b> <b>3,</b> <b>2023</b></h4><p block-type="ListGroup"><ul><li block-type="ListItem">Additional issues to consider <ul><li block-type="ListItem" class="list-indent-1">We need to add some guide or a link to documentation on the page so users can understand how cleanup steps work</li></ul><ul><li block-type="ListItem" class="list-indent-1">It's likely that cleanup steps do not work as expected when they don't start with go-to steps</li></ul><ul><li block-type="ListItem" class="list-indent-1">Customers may want to replay &amp; record only cleanup steps <ul><li block-type="ListItem" class="list-indent-2">In a sense, cleanup step groups might work better than cleanup steps built in a scenario</li></ul></li></ul></li></ul></p><h4><span id="page-10-1"></span><b>Notes</b> <b>@February</b> <b>22,</b> <b>2023</b></h4><p block-type="Text">Meeting recording -</p><p block-type="Text">https://us02web.zoom.us/rec/share/PMxHyvNKkVechDc3UtD4ejWUW472eJXNjMY Passcode: 3v8ge3.B</p><h4><span id="page-10-2"></span><b>Notes</b> <b>@February</b> <b>14,</b> <b>2023</b></h4><p block-type="Text">How can we design the feature to expand it in the future for marking groups of steps with different execution rules?</p><p block-type="Text">Functional UI to highlight new features</p><p block-type="Text">What if all a user creates an all clean up scenario?</p><h4><span id="page-10-3"></span><b>Notes</b> <b>@February</b> <b>8,</b> <b>2023</b></h4><p block-type="Text">Can we mark tests as specific with "cleanup failed" rather than just failed.</p><p block-type="Text">Cleanup steps can be added in run in the middle of scenarios or not?</p><p block-type="Text">Should the ability to toggle cleanup steps be included in the recorder for initial scope?</p><div block_type="$$PAGEBREAK$$"></div>